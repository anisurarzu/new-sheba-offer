{"ast":null,"code":"import _slicedToArray from\"/Users/macbookair/Desktop/Anis/Sheba Offer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import{getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword,onAuthStateChanged,GoogleAuthProvider,FacebookAuthProvider,signInWithPopup,updateProfile,getIdToken,signOut}from\"firebase/auth\";import initializeAuthentication from\"../Firebase/firebase.init\";// initialize firebase app\ninitializeAuthentication();var useFirebase=function useFirebase(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),authError=_useState6[0],setAuthError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),admin=_useState8[0],setAdmin=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),scholar=_useState10[0],setScholar=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),token=_useState12[0],setToken=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),userInfo=_useState14[0],setUserInfo=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),scholars=_useState16[0],setScholars=_useState16[1];var auth=getAuth();var googleProvider=new GoogleAuthProvider();var registerUser=function registerUser(email,password,name,history){createUserWithEmailAndPassword(auth,email,password).then(function(userCredential){setAuthError(\"\");var newUser={email:email,displayName:name};setUser(newUser);setLoading(false);// save user to the database\nsaveUser(email,name,\"POST\");// send name to firebase after creation\nupdateProfile(auth.currentUser,{displayName:name}).then(function(){}).catch(function(error){});history.replace(\"/\");}).catch(function(error){setAuthError(error.message);console.log(error);});};var loginUser=function loginUser(email,password,location,history){signInWithEmailAndPassword(auth,email,password).then(function(userCredential){var _location$state;var destination=(location===null||location===void 0?void 0:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.from)||\"/\";history.replace(destination);setAuthError(\"\");}).catch(function(error){setAuthError(error.message);}).finally(function(){return setLoading(false);});};var signInWithGoogle=function signInWithGoogle(location,history){signInWithPopup(auth,googleProvider).then(function(result){var _location$state2;var user=result.user;saveUser(user.email,user.displayName,\"PUT\");// saveUser(user.email, user.displayName, \"PUT\");\nsetAuthError(\"\");var destination=(location===null||location===void 0?void 0:(_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.from)||\"/\";history.replace(destination);}).catch(function(error){setAuthError(error.message);});};// observer user state\nuseEffect(function(){var unsubscribed=onAuthStateChanged(auth,function(user){if(user){setUser(user);setLoading(false);getIdToken(user).then(function(idToken){setToken(idToken);});}else{setUser({});setLoading(false);}});return function(){return unsubscribed;};},[auth]);useEffect(function(){fetch(\"https://yellow-sparkly-station.glitch.me/users/\".concat(user===null||user===void 0?void 0:user.email)).then(function(res){return res.json();}).then(function(data){return setAdmin(data===null||data===void 0?void 0:data.admin);});},[user===null||user===void 0?void 0:user.email]);useEffect(function(){fetch(\"https://yellow-sparkly-station.glitch.me/users/\".concat(user===null||user===void 0?void 0:user.email)).then(function(res){return res.json();}).then(function(data){return setScholar(data===null||data===void 0?void 0:data.scholar);});},[user===null||user===void 0?void 0:user.email]);useEffect(function(){fetch(\"https://yellow-sparkly-station.glitch.me/users/profile/\".concat(user===null||user===void 0?void 0:user.email)).then(function(res){return res.json();}).then(function(data){return setUserInfo(data);});},[user===null||user===void 0?void 0:user.email]);var logOut=function logOut(){signOut(auth).then(function(){setUser({});setLoading(false);// Sign-out successful.\n}).catch(function(error){// An error happened.\n});};var saveUser=function saveUser(email,displayName,method){console.log(displayName);var user={email:email,displayName:displayName};fetch(\"https://yellow-sparkly-station.glitch.me/users\",{method:method,headers:{\"content-type\":\"application/json\"},body:JSON.stringify(user)}).then();};// scholar finding\nuseEffect(function(){fetch(\"https://yellow-sparkly-station.glitch.me/users\").then(function(res){return res.json();}).then(function(data){var collectedScholar=data.filter(function(data){return data.role===\"scholar\";});setScholars(collectedScholar);});},[]);return{user:user,userInfo:userInfo,admin:admin,scholar:scholar,scholars:scholars,token:token,loading:loading,authError:authError,registerUser:registerUser,loginUser:loginUser,signInWithGoogle:signInWithGoogle,logOut:logOut};};export default useFirebase;","map":{"version":3,"sources":["/Users/macbookair/Desktop/Anis/Sheba Offer/src/hooks/useFirebase.js"],"names":["useState","useEffect","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","onAuthStateChanged","GoogleAuthProvider","FacebookAuthProvider","signInWithPopup","updateProfile","getIdToken","signOut","initializeAuthentication","useFirebase","user","setUser","loading","setLoading","authError","setAuthError","admin","setAdmin","scholar","setScholar","token","setToken","userInfo","setUserInfo","scholars","setScholars","auth","googleProvider","registerUser","email","password","name","history","then","userCredential","newUser","displayName","saveUser","currentUser","catch","error","replace","message","console","log","loginUser","location","destination","state","from","finally","signInWithGoogle","result","unsubscribed","idToken","fetch","res","json","data","logOut","method","headers","body","JSON","stringify","collectedScholar","filter","role"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport {\n  getAuth,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  onAuthStateChanged,\n  GoogleAuthProvider,\n  FacebookAuthProvider,\n  signInWithPopup,\n  updateProfile,\n  getIdToken,\n  signOut,\n} from \"firebase/auth\";\nimport initializeAuthentication from \"../Firebase/firebase.init\";\n\n// initialize firebase app\ninitializeAuthentication();\n\nconst useFirebase = () => {\n  const [user, setUser] = useState({});\n  const [loading, setLoading] = useState(true);\n\n  const [authError, setAuthError] = useState(\"\");\n  const [admin, setAdmin] = useState(false);\n  const [scholar, setScholar] = useState(false);\n  const [token, setToken] = useState(\"\");\n  const [userInfo, setUserInfo] = useState(\"\");\n\n  const [scholars, setScholars] = useState();\n\n  const auth = getAuth();\n  const googleProvider = new GoogleAuthProvider();\n\n  const registerUser = (email, password, name, history) => {\n    createUserWithEmailAndPassword(auth, email, password)\n      .then((userCredential) => {\n        setAuthError(\"\");\n        const newUser = { email, displayName: name };\n        setUser(newUser);\n        setLoading(false);\n        // save user to the database\n        saveUser(email, name, \"POST\");\n        // send name to firebase after creation\n        updateProfile(auth.currentUser, {\n          displayName: name,\n        })\n          .then(() => {})\n          .catch((error) => {});\n        history.replace(\"/\");\n      })\n      .catch((error) => {\n        setAuthError(error.message);\n        console.log(error);\n      });\n  };\n\n  const loginUser = (email, password, location, history) => {\n    signInWithEmailAndPassword(auth, email, password)\n      .then((userCredential) => {\n        const destination = location?.state?.from || \"/\";\n        history.replace(destination);\n        setAuthError(\"\");\n      })\n      .catch((error) => {\n        setAuthError(error.message);\n      })\n      .finally(() => setLoading(false));\n  };\n\n  const signInWithGoogle = (location, history) => {\n    signInWithPopup(auth, googleProvider)\n      .then((result) => {\n        const user = result.user;\n        saveUser(user.email, user.displayName, \"PUT\");\n        // saveUser(user.email, user.displayName, \"PUT\");\n        setAuthError(\"\");\n        const destination = location?.state?.from || \"/\";\n        history.replace(destination);\n      })\n      .catch((error) => {\n        setAuthError(error.message);\n      });\n  };\n\n  // observer user state\n  useEffect(() => {\n    const unsubscribed = onAuthStateChanged(auth, (user) => {\n      if (user) {\n        setUser(user);\n        setLoading(false);\n        getIdToken(user).then((idToken) => {\n          setToken(idToken);\n        });\n      } else {\n        setUser({});\n        setLoading(false);\n      }\n    });\n    return () => unsubscribed;\n  }, [auth]);\n\n  useEffect(() => {\n    fetch(`https://yellow-sparkly-station.glitch.me/users/${user?.email}`)\n      .then((res) => res.json())\n      .then((data) => setAdmin(data?.admin));\n  }, [user?.email]);\n\n  useEffect(() => {\n    fetch(`https://yellow-sparkly-station.glitch.me/users/${user?.email}`)\n      .then((res) => res.json())\n      .then((data) => setScholar(data?.scholar));\n  }, [user?.email]);\n\n  useEffect(() => {\n    fetch(\n      `https://yellow-sparkly-station.glitch.me/users/profile/${user?.email}`\n    )\n      .then((res) => res.json())\n      .then((data) => setUserInfo(data));\n  }, [user?.email]);\n\n  const logOut = () => {\n    signOut(auth)\n      .then(() => {\n        setUser({});\n        setLoading(false);\n        // Sign-out successful.\n      })\n      .catch((error) => {\n        // An error happened.\n      });\n  };\n\n  const saveUser = (email, displayName, method) => {\n    console.log(displayName);\n    const user = { email, displayName };\n    fetch(\"https://yellow-sparkly-station.glitch.me/users\", {\n      method: method,\n      headers: {\n        \"content-type\": \"application/json\",\n      },\n      body: JSON.stringify(user),\n    }).then();\n  };\n\n  // scholar finding\n  useEffect(() => {\n    fetch(\"https://yellow-sparkly-station.glitch.me/users\")\n      .then((res) => res.json())\n      .then((data) => {\n        const collectedScholar = data.filter((data) => data.role === \"scholar\");\n        setScholars(collectedScholar);\n      });\n  }, []);\n\n  return {\n    user,\n    userInfo,\n    admin,\n    scholar,\n    scholars,\n    token,\n    loading,\n    authError,\n    registerUser,\n    loginUser,\n    signInWithGoogle,\n    logOut,\n  };\n};\n\nexport default useFirebase;\n"]},"metadata":{},"sourceType":"module"}